library(tidyverse)
library(gtools)
library(drlib)
collatz <- function(n) if (gtools::even(n)) n/2L else 3*n+1L
get_coll_seq <- function(n) suppressWarnings(accumulate_while(n,collatz,~.x!=1) %>% as.integer)
df_coll <- data_frame(n=1:1e5,
coll=n%>%map(get_coll_seq),
coll_s=coll%>%map_chr(str_c,collapse=";"),
coll_max=coll%>%map_int(max),
coll_l=coll%>%map_int(length)) %>%
select(n,coll_l,coll_max,coll_s)
?accummulate
?accumulate
collatz <- function(x,y) if (x==1L) done(1L) else if (even(x)) x/2L else 3L*x+1L
#get_coll_seq <- function(n) accumulate_while(n,collatz,~.x!=1) %>% as.integer
get_coll_seq <- function(x) (1L:x)%>%accumulate(collatz,.init=x)%>%as.integer
1:10%>%accumulate(collatz,.init=10)
1:100%>%accumulate(collatz,.init=10)
library(tidyverse)
library(gtools)
collatz <- function(x,y) if (x==1L) done(1L) else if (even(x)) x/2L else 3L*x+1L
get_coll_seq <- function(x) (1L:x)%>%accumulate(collatz,.init=x)%>%as.integer
df_coll <- data_frame(n=1:1e5,
coll=n%>%map(get_coll_seq),
coll_s=coll%>%map_chr(str_c,collapse=";"),
coll_max=coll%>%map_int(max),
coll_l=coll%>%map_int(length)) %>%
select(n,coll_l,coll_max,coll_s)
df_coll <- data_frame(n=1:1e2,
coll=n%>%map(get_coll_seq),
coll_s=coll%>%map_chr(str_c,collapse=";"),
coll_max=coll%>%map_int(max),
coll_l=coll%>%map_int(length)) %>%
select(n,coll_l,coll_max,coll_s)
df_coll <- data_frame(n=1:1e2,
coll=n%>%map(get_coll_seq),
coll_s=coll%>%map_chr(str_c,collapse=";"),
coll_max=coll%>%map_int(max),
coll_l=coll%>%map_int(length)) %>%
select(n,coll_l,coll_max,coll_s)
df_coll
collatz <- function(x,y) if (x==1L) done(1L) else if (even(x)) x/2L else 3L*x+1L
get_coll_seq <- function(x) (1L:1000L)%>%accumulate(collatz,.init=x)%>%as.integer
collatz <- function(x,y) if (x==2L) done(1L) else if (even(x)) x/2L else 3L*x+1L
get_coll_seq <- function(x) (1L:1000L)%>%accumulate(collatz,.init=x)%>%as.integer
df_coll <- data_frame(n=1:1e2,
coll=n%>%map(get_coll_seq),
coll_s=coll%>%map_chr(str_c,collapse=";"),
coll_max=coll%>%map_int(max),
coll_l=coll%>%map_int(length)) %>%
select(n,coll_l,coll_max,coll_s)
df_coll
df_coll %>%
ggplot(aes(n,coll_l)) +
geom_line(alpha=.2) +
geom_smooth()
df_coll %>%
ggplot(aes(coll_l/n)) +
geom_freqpoly(aes(y = ..density..)) +
scale_x_log10()
map2_dbl(df_coll$coll_l,df_coll$n,~.x/.y)%>%mean
map2_dbl(df_coll$coll_l,df_coll$n,~.x/.y)%>%median
df_coll %>%
# select(-coll) %>%
write_csv("df_coll.csv")
coll27 <- df_coll%>%filter(n==27)%>%pull(coll_s)
data_frame(x=coll27%>%str_split(";")%>%first%>%as.integer)%>%mutate(i=row_number()) %>%
ggplot(aes(i,x))+
geom_line(color="blue") + geom_point(color="black") +
scale_y_log10() +
labs(title="Collatz Sequence",subtitle = "N=27",
y="N, log scale",x="Iteration")
coll27 <- df_coll%>%filter(n==27)%>%pull(coll_s)
data_frame(x=coll27%>%str_split(";")%>%first%>%as.integer)%>%mutate(i=row_number()) %>%
ggplot(aes(i,x))+
geom_line(color="blue") + geom_point(color="black") +
scale_y_log10() +
labs(title="Collatz Sequence",subtitle = "N=27",
y="N, log scale",x="Iteration")
library(tidyverse)
library(gtools)
